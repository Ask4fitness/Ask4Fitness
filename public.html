<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
  <title>Ask4Fitness â€“ Scoreboard</title>
</head>
<body>
  <header>
    <h1>Ask4Fitness Scoreboard</h1>
  </header>
  <main id="content"></main>
  <script>
    // Parse scoreboard data from hash (base64 encoded JSON)
    function render() {
      const container = document.getElementById('content');
      const hash = location.hash.substring(1);
      let data;
      try {
        data = JSON.parse(atob(hash));
      } catch (e) {
        data = null;
      }
      if (!data || !data.participants) {
        container.innerHTML = '<p>Mangler data. SÃ¸rg for Ã¥ Ã¥pne via lenken du fikk fra treneren.</p>';
        return;
      }
      const list = data.participants;
      // sort descending by points
      list.sort((a, b) => b.points - a.points);
      const maxPoints = list.length ? list[0].points : 0;
      const div = document.createElement('div');
      // Podium
      const podium = document.createElement('div');
      podium.className = 'podium';
      list.slice(0, 3).forEach((p, idx) => {
        const item = document.createElement('div');
        item.className = 'podium-item';
        item.innerHTML = `<span class="medal">${['ðŸ¥‡','ðŸ¥ˆ','ðŸ¥‰'][idx] || ''}</span><span class="name">${p.name}</span><span class="points">${p.points} poeng</span>`;
        podium.appendChild(item);
      });
      container.appendChild(podium);
      // Table
      const table = document.createElement('table');
      table.innerHTML = `<thead><tr><th>Deltaker</th><th>Poeng</th><th>Beste innsats</th><th>Progresjon</th></tr></thead><tbody>${list.map(p => `<tr><td>${p.name}</td><td>${p.points}</td><td>${p.bestCount}</td><td><div class="progress-bar"><div style="width:${maxPoints ? (p.points/maxPoints*100) : 0}%;"></div></div></td></tr>`).join('')}</tbody>`;
      container.appendChild(table);
      if (data.shoutout) {
        const shout = document.createElement('p');
        shout.className = 'shoutout';
        shout.textContent = `Shoutout: ${data.shoutout}`;
        container.appendChild(shout);
      }
    }
    render();
  </script>
</body>
</html>